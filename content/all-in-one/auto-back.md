---
title: 'nas的自动备份工具的选择  Restic  rclone duplicati等'
date: 2023-04-03T08:14:20+08:00
tag:
  - rclone
  - webdav
  - nas
  - Restic
  - sync
categories: 
  - rclone
  - webdav
  - nas
  - sync
  - Restic
---

### 场景
既然是nas 就需要做异地备份。
### 备份目的地
一般备份到网盘或对象储存比较划算。
如果数据量比较大，还是要备份到免费的网盘，比如阿里云盘 1-2T  123pan 2T，还有od gd等容量更大的选择。
用alist挂载后，只要不滥用，账号不会被封。   
数据量不大话，尤其核心数据，可以备份到对象储存，比如 alioss也不贵  七牛还有免费的10G kodo   
部分敏感数据需要加密储存。为了防止网盘删文件，尤其是小姐姐们，也需要加密储存。  
部分数据 需要按照版本储存。   
部分数据 需要按照原目录储存，方便在网盘可以直接访问。比如小姐姐们 可以直接存到pikpak
### 关于duplicati
也是我第一个使用的备份程序   
duplicati 是.net写的，可以装到pc 也可以装到服务器，支持linux(mono) ，也有docker版本   
支持加密储存，支持增量，支持版本储存。  
使用中发现的问题：
- 不支持按照原始目录储存方式
- 备份过程中会占用很大的本地硬盘空间
- 虽然他是基于rclone的，但不算是一个轻量化工具
### 关于rclone
可以用sysnc方式实现同步，可以不占用本地磁盘，但不支持的
- 没有图形界面
- 不支持按照版本保存
### restic
支持常见的储存模式，也支持rclone挂载的储存。也就是alist挂载的网盘也没问题。
rclone是文件同步，也就是和大部分网盘软件一样，来源文件是什么样的，目的文件就是什么样的。restic是面向文件的专业备份工具，其在备份文件前将会先进行加密再传输，而且是增量备份，只备份变化的部分。   
rclone并不记录文件版本，无法回溯特定时间点上的文件。restic会对每次备份生成一个快照，记录该时间点文件变化和存储结构，可以随时回溯到特定时间点的文件。   
### 最终的考量
考虑到 我要备份的文件主要有以下几种
- 文档类 修改频繁
- 代码类 gitea+github处理，不需要nas备份
- minio 思源笔记 修改频繁
- 影音视频 只需要同步
- 不合规的影音视频  需要单独同步备份到 境外网盘 或者加密同步到境内网盘
- 私人相册视频 加密同步到境内网盘
restic 不太熟悉需要时间看文档踩坑，最终决定 使用rclone+tar增量的方式，更底层 更轻量！

### 最终
单独一个lxc（pve）平台运行rclone，配置文件中挂载了包括alist  私有minio 阿里云对象储存 在内的我常用的储存   
并把部分储存挂载到本地，
然后用crontab 定时处理 ，全手动管理